<!doctype html>
<html lang="en">

<head>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-135440863-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <meta name="generator" content="Hugo 0.54.0" />

  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://multivac61.github.io/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://multivac61.github.io/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://multivac61.github.io/favicon-16x16.png">

  
  <link rel="manifest" href="https://multivac61.github.io/site.webmanifest">

  
  <link rel="mask-icon" href="https://multivac61.github.io/safari-pinned-tab.svg" color="">

  <meta name="msapplication-TileColor" content="">

  <meta name="theme-color" content="">

  
  <link rel="stylesheet" href="https://multivac61.github.io/css/bootstrap.min.css" />

  
  <title>Note to self.self: List comprehensions in Python 2.x leak! | multivac61.github.io</title>
  

  <script type="text/javascript" async
          src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
   MathJax.Hub.Config({
       tex2jax: {
           inlineMath: [['$','$'], ['\\(','\\)']],
           displayMath: [['$$','$$']],
           processEscapes: true,
           processEnvironments: true,
           skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
           TeX: { equationNumbers: { autoNumber: "AMS" },
                  extensions: ["AMSmath.js", "AMSsymbols.js"] }
       }
   });
   MathJax.Hub.Queue(function() {
       
       
       
       var all = MathJax.Hub.getAllJax(), i;
       for(i = 0; i < all.length; i += 1) {
           all[i].SourceElement().parentNode.className += ' has-jax';
       }
   });

   MathJax.Hub.Config({
       
       TeX: { equationNumbers: { autoNumber: "AMS" } }
   });
  </script>

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #ffffff;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}





</style>
</head>


<body>
  
  
  <div class="container">
    <article>
      <h1>Note to self.self: List comprehensions in Python 2.x leak!</h1>
<p>
  <small class="text-secondary">
  
  
  Oct 18, 2015, updated Feb 24, 2019
  </small>
  

<small><code><a href="https://multivac61.github.io/tags/python">python</a></code></small>

</p>
<p>After considerable amount of debugging on some code I&rsquo;ve been writing in Python 2.x I finally found the bug. This time it didn&rsquo;t arise because I was sloppy, as it so often does, but because of faulty behaviour intrinsic to the language design of Python 2.x itself..</p>

<figure>
    <img src="/images/18-dear-liza.png"/> 
</figure>

<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#ba2121">&#39;This is an example of list comprehension control variables being leaked to their outer scope&#39;</span>

<span style="color:#008000;font-weight:bold">for</span> i <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">range</span>(<span style="color:#666">10</span>):
    a <span style="color:#666">=</span> [i <span style="color:#008000;font-weight:bold">for</span> i <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">range</span>(<span style="color:#666">43</span>)]
    <span style="color:#008000;font-weight:bold">print</span>(i) <span style="color:#408080;font-style:italic"># will print 42 every time!</span></code></pre></div>
<p>It&rsquo;s no surprise that <a href="http://stackoverflow.com/questions/4575698/python-list-comprehension-overriding-value">others</a> have encountered this bug/feature before and it has supposedly been fixed in Python 3.x.</p>

<p>Maybe this is a good example of why I should be switching over to Python 3.x soon&hellip;ish&hellip;</p>

    </article>
  </div>

  
  
  

  
</body>

</html>